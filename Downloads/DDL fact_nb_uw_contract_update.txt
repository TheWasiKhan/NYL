DROP TABLE IF EXISTS pdm_conv.fact_nb_uw_contract_update;
CREATE TABLE pdm_conv.fact_nb_uw_contract_update(
fact_nb_uw_contract_sk BIGINT,
src_sys_nm_nk VARCHAR(50),
case_num VARCHAR(25),
cnt_id_nk VARCHAR(25),
src_cnt_ref_id BIGINT,
dim_nb_contract_sk BIGINT,
dim_nb_product_sk BIGINT,
product_cd VARCHAR(20),
plan_cd VARCHAR(20),
plan_ver_num VARCHAR(20),
plan_nm VARCHAR(500),
appl_tp_desc VARCHAR(50),
auto_uw_ind VARCHAR(1),
dim_nb_status_sk BIGINT,
nb_cnt_sts_cd VARCHAR(10),
nb_cnt_sts_dt timestamptz,
dim_uw_location_sk BIGINT,
uw_srvc_cntr_cd_nk VARCHAR(10),
dim_organization_sk BIGINT,
go_cd VARCHAR(10),
go_cd_nk VARCHAR(10),
go_cd_nm VARCHAR(100),
dim_cnt_sk BIGINT,
cnt_iss_cd_nk VARCHAR(3),
cnt_dat_src_cd_nk VARCHAR(3),
nb_cnt_propsl_date_sk INTEGER,
nb_cnt_propsl_dt DATE,
initial_uw_start_date_sk INTEGER,
initial_uw_start_dt timestamptz,
ltst_uw_restart_dt DATE,
final_uw_cmpl_dt DATE,
four_mth_taar_amt DECIMAL(32,2),
primary_insured_2_yr_taar_amt DECIMAL(32,2),
est_annual_prem_amt DECIMAL(32,2),
accel_case_yn_ind VARCHAR(1),
acsv_except_ind VARCHAR(1),
rgasup_ind VARCHAR(1),
sys_push_ind VARCHAR(1),
updt_mib_yn_ind VARCHAR(1),
ftis_calc_tp_cd VARCHAR(50),
route_back_to_uw_ind VARCHAR(1),
has_assoc_policy_ind VARCHAR(1),
adv_commission_dcsn_ind VARCHAR(1),
adv_commission_sts_cd VARCHAR(1),
adv_commision_dt DATE,
addl_offer_ltr_allow_yn_ind VARCHAR(1),
addl_offer_ltr_appr_ind VARCHAR(1),
addl_offer_ltr_pct_num DECIMAL(10,6),
addl_offer_ltr_max_allow_amt DECIMAL(16,2),
addl_offer_ltr_initial_offer_a DECIMAL(16,2),
addl_offer_ltr_appr_amt DECIMAL(16,2),
addl_offer_ltr_dcln_dim_rsn_sk BIGINT,
addl_offer_ltr_dcln_rsn_cd VARCHAR(10),
addl_offer_ltr_dcln_other_rsn VARCHAR(512),
cnt_tca_strt_dt DATE,
cnt_tca_end_dt DATE,
cnt_tca_exp_dt DATE,
cnt_tca_wthdrn_dt DATE,
aatc_cmpgn_elg_yn_ind VARCHAR(1),
uw_dcsn_tp_cd VARCHAR(20),
modal_prem_amt DECIMAL(16,2),
cnt_rec_sts_cd VARCHAR(10),
cnt_rec_sts_dt timestamptz,
src_rec_sts_cd VARCHAR(10),
chksum VARCHAR(32),
edh_record_status_in VARCHAR(1),
edh_record_start_ts timestamptz,
edh_record_end_ts timestamptz,
edh_created_batch_key BIGINT,
edh_created_ts timestamptz,
edh_created_nm VARCHAR(50),
edh_updated_batch_key BIGINT,
edh_updated_ts timestamptz,
edh_updated_nm VARCHAR(50),
trans_uw_ind VARCHAR(1),
first_dcsn_dt timestamptz,
first_dcsn_risk_class_nm VARCHAR(100),
last_dcsn_dt timestamptz,
last_dcsn_risk_class_nm VARCHAR(100),
nyl_express_iss_result VARCHAR(30));


DROP TABLE IF EXISTS pdm_conv.fact_nb_uw_contract_insert;
CREATE TABLE pdm_conv.fact_nb_uw_contract_insert
(
fact_nb_uw_contract_sk BIGINT,
src_sys_nm_nk VARCHAR(50),
case_num VARCHAR(25),
cnt_id_nk VARCHAR(25),
src_cnt_ref_id BIGINT,
dim_nb_contract_sk BIGINT,
dim_nb_product_sk BIGINT,
product_cd VARCHAR(20),
plan_cd VARCHAR(20),
plan_ver_num VARCHAR(20),
plan_nm VARCHAR(500),
appl_tp_desc VARCHAR(50),
auto_uw_ind VARCHAR(1),
dim_nb_status_sk BIGINT,
nb_cnt_sts_cd VARCHAR(10),
nb_cnt_sts_dt timestamptz,
dim_uw_location_sk BIGINT,
uw_srvc_cntr_cd_nk VARCHAR(10),
dim_organization_sk BIGINT,
go_cd VARCHAR(10),
go_cd_nk VARCHAR(10),
go_cd_nm VARCHAR(100),
dim_cnt_sk BIGINT,
cnt_iss_cd_nk VARCHAR(3),
cnt_dat_src_cd_nk VARCHAR(3),
nb_cnt_propsl_date_sk INTEGER,
nb_cnt_propsl_dt DATE,
initial_uw_start_date_sk INTEGER,
initial_uw_start_dt timestamptz,
ltst_uw_restart_dt DATE,
final_uw_cmpl_dt DATE,
four_mth_taar_amt DECIMAL(32,2),
primary_insured_2_yr_taar_amt DECIMAL(32,2),
est_annual_prem_amt DECIMAL(32,2),
accel_case_yn_ind VARCHAR(1),
acsv_except_ind VARCHAR(1),
rgasup_ind VARCHAR(1),
sys_push_ind VARCHAR(1),
updt_mib_yn_ind VARCHAR(1),
ftis_calc_tp_cd VARCHAR(50),
route_back_to_uw_ind VARCHAR(1),
has_assoc_policy_ind VARCHAR(1),
adv_commission_dcsn_ind VARCHAR(1),
adv_commission_sts_cd VARCHAR(1),
adv_commision_dt DATE,
addl_offer_ltr_allow_yn_ind VARCHAR(1),
addl_offer_ltr_appr_ind VARCHAR(1),
addl_offer_ltr_pct_num DECIMAL(10,6),
addl_offer_ltr_max_allow_amt DECIMAL(16,2),
addl_offer_ltr_initial_offer_a DECIMAL(16,2),
addl_offer_ltr_appr_amt DECIMAL(16,2),
addl_offer_ltr_dcln_dim_rsn_sk BIGINT,
addl_offer_ltr_dcln_rsn_cd VARCHAR(10),
addl_offer_ltr_dcln_other_rsn VARCHAR(512),
cnt_tca_strt_dt DATE,
cnt_tca_end_dt DATE,
cnt_tca_exp_dt DATE,
cnt_tca_wthdrn_dt DATE,
aatc_cmpgn_elg_yn_ind VARCHAR(1),
uw_dcsn_tp_cd VARCHAR(20),
modal_prem_amt DECIMAL(16,2),
cnt_rec_sts_cd VARCHAR(10),
cnt_rec_sts_dt timestamptz,
src_rec_sts_cd VARCHAR(10),
chksum VARCHAR(32),
edh_record_status_in VARCHAR(1),
edh_record_start_ts timestamptz,
edh_record_end_ts timestamptz,
edh_created_batch_key BIGINT,
edh_created_ts timestamptz,
edh_created_nm VARCHAR(50),
edh_updated_batch_key BIGINT,
edh_updated_ts timestamptz,
edh_updated_nm VARCHAR(50),
trans_uw_ind VARCHAR(1),
first_dcsn_dt timestamptz,
first_dcsn_risk_class_nm VARCHAR(100),
last_dcsn_dt timestamptz,
last_dcsn_risk_class_nm VARCHAR(100),
nyl_express_iss_result VARCHAR(30));
